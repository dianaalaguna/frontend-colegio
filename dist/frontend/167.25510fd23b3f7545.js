"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[167],{6167:(C,l,d)=>{d.r(l),d.d(l,{EstudiantesListaComponent:()=>h});var r=d(496),_=d(6443),u=d(316),t=d(8559),g=d(9169);function m(a,c){if(1&a){const n=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.resetBusqueda())}),t.EFF(1,"Limpiar"),t.k0s()}}function E(a,c){if(1&a){const n=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",11),t.mxI("ngModelChange",function(e){const s=t.eBV(n).$implicit,o=t.XpG();return t.DH7(o.editCache[s.codigoEstudiante].codigoEstudiante,e)||(o.editCache[s.codigoEstudiante].codigoEstudiante=e),t.Njj(e)}),t.k0s()(),t.j41(3,"td")(4,"input",12),t.mxI("ngModelChange",function(e){const s=t.eBV(n).$implicit,o=t.XpG();return t.DH7(o.editCache[s.codigoEstudiante].nombres,e)||(o.editCache[s.codigoEstudiante].nombres=e),t.Njj(e)}),t.bIt("input",function(){const e=t.eBV(n).$implicit,s=t.XpG();return t.Njj(s.onChange(e.codigoEstudiante,"nombres",s.editCache[e.codigoEstudiante].nombres))}),t.k0s()(),t.j41(5,"td")(6,"input",12),t.mxI("ngModelChange",function(e){const s=t.eBV(n).$implicit,o=t.XpG();return t.DH7(o.editCache[s.codigoEstudiante].apellidos,e)||(o.editCache[s.codigoEstudiante].apellidos=e),t.Njj(e)}),t.bIt("input",function(){const e=t.eBV(n).$implicit,s=t.XpG();return t.Njj(s.onChange(e.codigoEstudiante,"apellidos",s.editCache[e.codigoEstudiante].apellidos))}),t.k0s()(),t.j41(7,"td")(8,"input",12),t.mxI("ngModelChange",function(e){const s=t.eBV(n).$implicit,o=t.XpG();return t.DH7(o.editCache[s.codigoEstudiante].correoTutor,e)||(o.editCache[s.codigoEstudiante].correoTutor=e),t.Njj(e)}),t.bIt("input",function(){const e=t.eBV(n).$implicit,s=t.XpG();return t.Njj(s.onChange(e.codigoEstudiante,"correoTutor",s.editCache[e.codigoEstudiante].correoTutor))}),t.k0s()(),t.j41(9,"td")(10,"input",11),t.mxI("ngModelChange",function(e){const s=t.eBV(n).$implicit,o=t.XpG();return t.DH7(o.editCache[s.codigoEstudiante].nacimiento,e)||(o.editCache[s.codigoEstudiante].nacimiento=e),t.Njj(e)}),t.k0s()(),t.j41(11,"td")(12,"button",13),t.bIt("click",function(){const e=t.eBV(n).$implicit,s=t.XpG();return t.Njj(s.saveChanges(e.codigoEstudiante))}),t.EFF(13,"Guardar"),t.k0s(),t.j41(14,"button",14),t.bIt("click",function(){const e=t.eBV(n).$implicit,s=t.XpG();return t.Njj(s.deleteUser(e.codigoEstudiante))}),t.EFF(15,"Eliminar"),t.k0s()()()}if(2&a){const n=c.$implicit,i=t.XpG();t.R7$(2),t.R50("ngModel",i.editCache[n.codigoEstudiante].codigoEstudiante),t.R7$(2),t.R50("ngModel",i.editCache[n.codigoEstudiante].nombres),t.R7$(2),t.R50("ngModel",i.editCache[n.codigoEstudiante].apellidos),t.R7$(2),t.R50("ngModel",i.editCache[n.codigoEstudiante].correoTutor),t.R7$(2),t.R50("ngModel",i.editCache[n.codigoEstudiante].nacimiento),t.R7$(2),t.Y8G("disabled",!i.hasChanges(n.codigoEstudiante))}}function p(a,c){1&a&&(t.j41(0,"div",15),t.EFF(1," No se encontraron estudiantes. "),t.k0s())}let h=(()=>{class a{constructor(n){this.studentService=n,this.estudiantes=[],this.editCache={},this.busquedaEmailTutor=""}ngOnInit(){this.loadEstudiantes()}loadEstudiantes(){this.studentService.getStudents().subscribe({next:n=>{this.estudiantes=n,this.inicializarEditCache()},error:n=>{console.error("Error al cargar los estudiantes",n)}})}buscarEstudiante(){const n=this.busquedaEmailTutor.trim();n&&this.studentService.getStudentsByEmail(n).subscribe({next:i=>{this.estudiantes=i,this.inicializarEditCache()},error:i=>{console.error("Usuario no encontrado",i),this.estudiantes=[]}})}inicializarEditCache(){this.editCache={},this.estudiantes.forEach(n=>{this.editCache[n.codigoEstudiante]={...n}})}hasChanges(n){return JSON.stringify(this.editCache[n])!==JSON.stringify(this.estudiantes.find(i=>i.codigoEstudiante===n))}onChange(n,i,e){this.editCache[n]&&(this.editCache[n][i]=e)}saveChanges(n){const i=this.editCache[n];console.log("Guardando estudiante:",i),this.studentService.updateStudent(n,i).subscribe({next:()=>{console.log("Estudiante actualizado"),this.loadEstudiantes()},error:e=>{console.error("Error al guardar los cambios",e)}})}deleteUser(n){window.confirm("\xbfEst\xe1s seguro de que deseas eliminar este estudiante?")&&this.studentService.deleteUser(n).subscribe({next:()=>{console.log("Usuario eliminado"),this.loadEstudiantes()},error:e=>{console.error("Error al eliminar el usuario",e)}})}resetBusqueda(){this.busquedaEmailTutor="",this.loadEstudiantes()}static{this.\u0275fac=function(i){return new(i||a)(t.rXU(g.b))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-estudiantes-lista"]],standalone:!0,features:[t.aNF],decls:27,vars:4,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"input-group",2,"width","300px"],["type","email","placeholder","Buscar por email",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click"],["class","btn btn-secondary",3,"click",4,"ngIf"],[1,"table","table-bordered","table-hover"],[1,"table-dark"],[4,"ngFor","ngForOf"],["class","alert alert-warning text-center",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],["readonly","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-control",3,"ngModelChange","input","ngModel"],[1,"btn","btn-success","btn-sm","me-2",3,"click","disabled"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"alert","alert-warning","text-center"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3,"\u{1f465} Lista de Estudiantes"),t.k0s(),t.j41(4,"div",2)(5,"input",3),t.mxI("ngModelChange",function(o){return t.DH7(e.busquedaEmailTutor,o)||(e.busquedaEmailTutor=o),o}),t.k0s(),t.j41(6,"button",4),t.bIt("click",function(){return e.buscarEstudiante()}),t.EFF(7,"Buscar"),t.k0s(),t.DNE(8,m,2,0,"button",5),t.k0s()(),t.j41(9,"table",6)(10,"thead",7)(11,"tr")(12,"th"),t.EFF(13,"C\xf3digo"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Nombres"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Apellidos"),t.k0s(),t.j41(18,"th"),t.EFF(19,"E-Mail tutor"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Cumplea\xf1os"),t.k0s(),t.j41(22,"th"),t.EFF(23,"Acciones"),t.k0s()()(),t.j41(24,"tbody"),t.DNE(25,E,16,6,"tr",8),t.k0s()(),t.DNE(26,p,2,0,"div",9),t.k0s()),2&i&&(t.R7$(5),t.R50("ngModel",e.busquedaEmailTutor),t.R7$(3),t.Y8G("ngIf",e.busquedaEmailTutor),t.R7$(17),t.Y8G("ngForOf",e.estudiantes),t.R7$(),t.Y8G("ngIf",0===e.estudiantes.length))},dependencies:[r.YN,r.me,r.BC,r.vS,_.q1,u.MD,u.Sq,u.bT]})}}return a})()}}]);
//# sourceMappingURL=167.25510fd23b3f7545.js.map