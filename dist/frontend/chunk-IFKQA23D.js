import{a as V}from"./chunk-2W3Z6WZ4.js";import{b as w,e as A,h as k,i as D,j as T,n as N}from"./chunk-KCB7IB6P.js";import{a as B}from"./chunk-YXKEXZIP.js";import"./chunk-K7YZQKDG.js";import{$a as I,Cb as F,Eb as O,Ia as g,Ja as P,Ka as d,Ma as o,Na as i,Pa as v,Qa as x,Ra as b,Wa as n,Xa as m,Z as h,Za as C,a as S,ab as M,b as _,bb as y,db as j,ga as f,ha as u,nb as E,va as a,wa as c}from"./chunk-ZTNMYY3J.js";function W(s,p){if(s&1&&(o(0,"option",11),n(1),i()),s&2){let e=p.$implicit;d("value",e._id),a(),C(" ",e.nombres," ",e.apellidos," ")}}function $(s,p){if(s&1){let e=v();o(0,"tr")(1,"td"),n(2),i(),o(3,"td"),n(4),i(),o(5,"td"),n(6),i(),o(7,"td")(8,"select",7),y("ngModelChange",function(r){let l=f(e).$implicit;return M(l.selectedProfesorId,r)||(l.selectedProfesorId=r),u(r)}),o(9,"option",8),n(10,"Profesor"),i(),g(11,W,2,3,"option",9),i()(),o(12,"td")(13,"button",10),x("click",function(){let r=f(e).$implicit,l=b();return u(l.asignarProfesor(r))}),n(14,"Asignar"),i()()()}if(s&2){let e=p.$implicit,t=b();a(2),m(e.nombre),a(2),m(e.grado),a(2),m(e.periodo),a(2),I("ngModel",e.selectedProfesorId),P("key",e._id),a(3),d("ngForOf",t.profesores)}}var J=(()=>{class s{constructor(e,t,r){this.subjectService=e,this.userService=t,this.cdr=r,this.subjects=[],this.profesores=[],this.selectedProfesorId=null,this.selectedSubjectId=null}ngOnInit(){this.userService.getProfesores().subscribe(e=>{this.profesores=e,this.loadSubjects()})}loadSubjects(){this.subjectService.getSubjectsWithoutProfessors().subscribe(e=>{this.subjects=e.map(t=>{let r="";return t.profesores&&t.profesores.length>0&&(r=String(t.profesores[0])),_(S({},t),{selectedProfesorId:r})})})}loadProfesores(){this.userService.getProfesores().subscribe(e=>{console.log("Profesores:",e),this.profesores=e})}asignarProfesor(e){let t=e.selectedProfesorId;if(!t){alert("Por favor selecciona un profesor");return}this.subjectService.asociarProfesor(e._id,t).subscribe({next:r=>{alert("Profesor asignado correctamente"),this.loadSubjects()},error:r=>{alert(r.error.message||"Error al asignar profesor"),console.error(r)}})}trackBySubjectId(e,t){return t._id}static{this.\u0275fac=function(t){return new(t||s)(c(B),c(V),c(E))}}static{this.\u0275cmp=h({type:s,selectors:[["app-asignar-profesor"]],standalone:!0,features:[j],decls:22,vars:2,consts:[[1,"container","mt-4"],[1,"mb-4"],[1,"row"],[1,"col-md-12"],[1,"table","table-bordered","table-hover"],[1,"table-dark"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"form-control",3,"ngModelChange","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-success","mt-3",3,"click"],[3,"value"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"h2",1),n(2,"\u{1F4DA} Asignar Profesor a Materia"),i(),o(3,"div",2)(4,"div",3)(5,"h4"),n(6,"Materias"),i(),o(7,"table",4)(8,"thead",5)(9,"tr")(10,"th"),n(11,"Nombre"),i(),o(12,"th"),n(13,"Grado"),i(),o(14,"th"),n(15,"Periodo"),i(),o(16,"th"),n(17,"Profesores"),i(),o(18,"th"),n(19,"Acci\xF3n"),i()()(),o(20,"tbody"),g(21,$,15,6,"tr",6),i()()()()()),t&2&&(a(21),d("ngForOf",r.subjects)("ngForTrackBy",r.trackBySubjectId))},dependencies:[O,F,N,D,T,k,w,A],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}select.form-control[_ngcontent-%COMP%]{appearance:auto;-webkit-appearance:auto;-moz-appearance:auto}"]})}}return s})();export{J as AsignarProfesorComponent};
