"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[819],{3819:(b,_,a)=>{a.r(_),a.d(_,{UsuariosComponent:()=>g});var u=a(4341),d=a(1626),c=a(177),e=a(4438),m=a(9885);function p(o,l){if(1&o){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetBusqueda())}),e.EFF(1,"Limpiar"),e.k0s()}}function h(o,l){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"input",11),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit,i=e.XpG();return e.DH7(i.editCache[r.username].nombres,n)||(i.editCache[r.username].nombres=n),e.Njj(n)}),e.bIt("input",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.onChange(n.username,"nombres",r.editCache[n.username].nombres))}),e.k0s()(),e.j41(3,"td")(4,"input",11),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit,i=e.XpG();return e.DH7(i.editCache[r.username].apellidos,n)||(i.editCache[r.username].apellidos=n),e.Njj(n)}),e.bIt("input",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.onChange(n.username,"apellidos",r.editCache[n.username].apellidos))}),e.k0s()(),e.j41(5,"td")(6,"input",11),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit,i=e.XpG();return e.DH7(i.editCache[r.username].telefono,n)||(i.editCache[r.username].telefono=n),e.Njj(n)}),e.bIt("input",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.onChange(n.username,"telefono",r.editCache[n.username].telefono))}),e.k0s()(),e.j41(7,"td")(8,"input",12),e.mxI("ngModelChange",function(n){const r=e.eBV(t).$implicit,i=e.XpG();return e.DH7(i.editCache[r.username].username,n)||(i.editCache[r.username].username=n),e.Njj(n)}),e.k0s()(),e.j41(9,"td")(10,"button",13),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.saveChanges(n.username))}),e.EFF(11,"Guardar"),e.k0s(),e.j41(12,"button",14),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG();return e.Njj(r.deleteUser(n.username))}),e.EFF(13,"Eliminar"),e.k0s()()()}if(2&o){const t=l.$implicit,s=e.XpG();e.R7$(2),e.R50("ngModel",s.editCache[t.username].nombres),e.R7$(2),e.R50("ngModel",s.editCache[t.username].apellidos),e.R7$(2),e.R50("ngModel",s.editCache[t.username].telefono),e.R7$(2),e.R50("ngModel",s.editCache[t.username].username),e.R7$(2),e.Y8G("disabled",!s.hasChanges(t.username))}}function C(o,l){1&o&&(e.j41(0,"div",15),e.EFF(1," No se encontraron usuarios. "),e.k0s())}let g=(()=>{class o{constructor(t){this.userService=t,this.usuarios=[],this.editCache={},this.busquedaUsername=""}ngOnInit(){this.loadUsuarios()}loadUsuarios(){this.userService.getUsers().subscribe({next:t=>{this.usuarios=t,this.inicializarEditCache()},error:t=>{console.error("Error al cargar los usuarios",t)}})}buscarUsuario(){const t=this.busquedaUsername.trim();t&&this.userService.getUserByUsername(t).subscribe({next:s=>{this.usuarios=[s],this.inicializarEditCache()},error:s=>{console.error("Usuario no encontrado",s),this.usuarios=[]}})}inicializarEditCache(){this.editCache={},this.usuarios.forEach(t=>{this.editCache[t.username]={...t}})}hasChanges(t){return JSON.stringify(this.editCache[t])!==JSON.stringify(this.usuarios.find(s=>s.username===t))}onChange(t,s,n){this.editCache[t]&&(this.editCache[t][s]=n)}saveChanges(t){this.userService.updateUser(t,this.editCache[t]).subscribe({next:()=>{console.log("Usuario actualizado"),this.loadUsuarios()},error:n=>{console.error("Error al guardar los cambios",n)}})}deleteUser(t){window.confirm("\xbfEst\xe1s seguro de que deseas eliminar este usuario?")&&this.userService.deleteUser(t).subscribe({next:()=>{console.log("Usuario eliminado"),this.loadUsuarios()},error:n=>{console.error("Error al eliminar el usuario",n)}})}resetBusqueda(){this.busquedaUsername="",this.loadUsuarios()}static{this.\u0275fac=function(s){return new(s||o)(e.rXU(m.D))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-usuarios"]],standalone:!0,features:[e.aNF],decls:25,vars:4,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"input-group",2,"width","300px"],["type","email","placeholder","Buscar por email",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary",3,"click"],["class","btn btn-secondary",3,"click",4,"ngIf"],[1,"table","table-bordered","table-hover"],[1,"table-dark"],[4,"ngFor","ngForOf"],["class","alert alert-warning text-center",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],[1,"form-control",3,"ngModelChange","input","ngModel"],["readonly","",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-success","btn-sm","me-2",3,"click","disabled"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"alert","alert-warning","text-center"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3,"\u{1f465} Lista de Usuarios"),e.k0s(),e.j41(4,"div",2)(5,"input",3),e.mxI("ngModelChange",function(i){return e.DH7(n.busquedaUsername,i)||(n.busquedaUsername=i),i}),e.k0s(),e.j41(6,"button",4),e.bIt("click",function(){return n.buscarUsuario()}),e.EFF(7,"Buscar"),e.k0s(),e.DNE(8,p,2,0,"button",5),e.k0s()(),e.j41(9,"table",6)(10,"thead",7)(11,"tr")(12,"th"),e.EFF(13,"Nombres"),e.k0s(),e.j41(14,"th"),e.EFF(15,"Apellidos"),e.k0s(),e.j41(16,"th"),e.EFF(17,"Tel\xe9fono"),e.k0s(),e.j41(18,"th"),e.EFF(19,"E-Mail"),e.k0s(),e.j41(20,"th"),e.EFF(21,"Acciones"),e.k0s()()(),e.j41(22,"tbody"),e.DNE(23,h,14,5,"tr",8),e.k0s()(),e.DNE(24,C,2,0,"div",9),e.k0s()),2&s&&(e.R7$(5),e.R50("ngModel",n.busquedaUsername),e.R7$(3),e.Y8G("ngIf",n.busquedaUsername),e.R7$(15),e.Y8G("ngForOf",n.usuarios),e.R7$(),e.Y8G("ngIf",0===n.usuarios.length))},dependencies:[u.YN,u.me,u.BC,u.vS,d.q1,c.MD,c.Sq,c.bT]})}}return o})()}}]);